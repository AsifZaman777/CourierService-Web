@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<!-- ============================================================== -->
<!-- Start Page Content here -->
<!-- ============================================================== -->

<div class="content-page">
    <div class="content">
        <style>
            /* Make all <i> tags black */
            i {
                text-decoration: none !important;
                color: black;
            }

            /* Remove text decoration from all <i> tags */
            i {
            }
        </style>

        <!-- Start Content-->
        <div class="container-fluid">

            <!-- start page title -->
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box">
                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="javascript: void(0);">Dashboard</a></li>

                            </ol>
                        </div>
                        <h4 class="page-title">Dashboard</h4>
                    </div>
                </div>
            </div>
            <!-- end page title -->


            <div class="row justify-content-center">
                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-warning d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Pending Pickup Requests</h6>
                                <h3 class="my-3" data-plugin="counterup">@ViewBag.TotalPickupRequest</h3>
                            </div>
                            <i class="fas fa-truck-loading fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-success d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">In Hub</h6>
                                <h3 class="my-3"><span data-plugin="counterup">@ViewBag.ParcelInHub</span></h3>
                            </div>
                            <i class="fas fa-warehouse fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-primary d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Delivered Today</h6>
                                <h3 class="my-3"><span data-plugin="counterup">@ViewBag.TodayDelivered</span></h3>
                            </div>
                            <i class="fas fa-check-circle fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-success d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Total Delivered</h6>
                                <h3 class="my-3"><span data-plugin="counterup">@ViewBag.TotalDelivered</span></h3>
                            </div>
                            <i class="fas fa-truck fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-red d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Parcel On The Way</h6>
                                <h3 class="my-3"><span data-plugin="counterup">@ViewBag.ParcelOnTheWay</span></h3>
                            </div>
                            <i class="fas fa-shipping-fast fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-warning d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Total Returned</h6>
                                <h3 class="my-3" data-plugin="counterup">@ViewBag.ReturnParcelCount</h3>
                            </div>
                            <i class="fas fa-arrow-circle-left fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                <div class="col-md-6 col-xl-3">
                    <a href="@Url.Action("Parcels", "Merchant")">
                        <div class="card-box tilebox-one bg-success d-flex align-items-center justify-content-between">
                            <div>
                                <h6 class="text-black font-weight-bold text-uppercase mt-0">Parcel Count</h6>
                                <h3 class="my-3"><span data-plugin="counterup">@ViewBag.TotalParcel</span></h3>
                            </div>
                            <i class="fas fa-box fa-3x text-black"></i>
                        </div>
                    </a>
                </div>

                
            </div>


            <hr />
            <!-- end row -->
            

            <div class="row justify-content-center">


                <div class="card mx-auto" style="max-width: 400px;">
                    <div class="card-body">
                        <h5 class="card-title text-center">Today's Accounts</h5>
                        <table class="table">
                            <tbody>

                                <tr>
                                    <th scope="row">Total Amount</th>
                                    <td>@ViewBag.TotalPriceSum BDT</td>
                                </tr>
                                <tr>
                                    <th scope="row">Amount Received</th>
                                    <td>@ViewBag.AmountPaid BDT</td>
                                </tr>
                                <tr>
                                    <th scope="row">Amount Due</th>
                                    <td>@ViewBag.DueAmount BDT</td>
                                </tr>

                                @* <tr>
                                <th scope="row">Now Payable</th>
                                <td>@ViewBag.TodayPayment BDT</td>
                                </tr> *@
                            </tbody>
                        </table>
                    </div>
                </div>
                   



            </div>
            <!-- end row -->

            <div class="row justify-content-center">


                   
            </div>
            


            <!-- end row -->

            <div class="row justify-content-center">
                <div class="col-lg-12">
                    <div class="card-box">
                        <h4 class="header-title text-success">Notifications</h4>
                        @{
                            int sl = 1;
                        }
                        <div class="table-responsive">
                            <table class="table mb-0">
                                <thead>
                                    <tr>
                                        <th>SL</th>
                                        <th>Title</th>
                                        <th>Message</th>
                                        <th>Product Price</th>
                                        <th>Requested Product Price</th>
                                        <th>Rider Name</th>
                                        <th>Date</th>
                                        <th>Parcel ID</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var notification in ViewBag.Notifications)
                                    {
                                        <tr>
                                            <td>@sl</td>
                                            <td>@notification.Title</td>
                                            <td>@notification.Message</td>
                                            <td>@notification.Parcel.ProductPrice</td>
                                            <td>@notification.RequestedPrice</td>
                                            <td>@notification.Parcel.Rider.Name</td>
                                            <td>@notification.Date</td>
                                            <td>@notification.ParcelId</td>

                                            @if (notification.Status == 0)
                                            {
                                                <td>
                                                    <form  method="post">
                                                        <input type="hidden" name="parcelId" value="@notification.ParcelId" />
                                                        <input type="hidden" name="newPrice" value="@notification.RequestedPrice" />
                                                        <button asp-action="ApprovePermission" type="submit" class="btn btn-success">Approve</button>
                                                    </form>
                                                </td>
                                            }
                                            else if (notification.Status == 1)
                                            {
                                                <td>
                                                   <span>Approved</span>
                                                </td>
                                            }
                                            else
                                            {
                                                <td>
                                                    <button class="btn btn-danger">Rejected</button>
                                                </td>

                                            }

                                        </tr>
                                        sl++;
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- end row -->

        </div> <!-- end container-fluid -->

    </div> <!-- end content -->





</div>

<!-- ============================================================== -->
<!-- End Page content -->
<!-- ============================================================== -->
<script>
    // Wait for the document to be ready
    document.addEventListener("DOMContentLoaded", function () {
        // Get all approve buttons
        var approveButtons = document.querySelectorAll('[id^="approveButton_"]');

        // Loop through each approve button
        approveButtons.forEach(function (button) {
            // Add event listener for click event
            button.addEventListener('click', function () {
                // Get the parent form of the clicked button
                var form = button.closest('form');
                // Disable the button to prevent multiple submissions
                button.disabled = true;
                // Hide the parent form
                form.style.display = 'none';
            });
        });
    });
</script>